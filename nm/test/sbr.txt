# State-Based Rule Production.
#

###############################################################################
# TC 1 Generate Reports based on a variable.
###############################################################################
# This test will cause an Agent FULL REPORT to be generated
# up to 5 times whenever Variable V5 == 1.
###############################################################################


#------------------------------------------------------------------------------
# Step 1.1: Define UINT V5 = 0.
#------------------------------------------------------------------------------
# V5 ARI = 0xac01410501
#------------------------------------------------------------------------------
c11541005585054324261145ac01410501464514814243004114
WAIT 1

#------------------------------------------------------------------------------
# Step 1.2: Retrieve value of V5 in a report.
#------------------------------------------------------------------------------
c11541054f8405422523478145ac014105014180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.3: Confirm value of V5 is 0.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.4: Define Macro M1 generate an agent FULL_REPORT and reset V5 = 0
#------------------------------------------------------------------------------
# Macro = [genRpt([FULL_REPORT], 0), Store(V5, 0)]
# M1 ARI = 0xa401410501
#------------------------------------------------------------------------------
c115410758418505431224254463746d7045a401410501582e8254c11541054f84054225234781458718194100418057c115410e52840542242645ac0141050146451481424300
WAIT 1

#------------------------------------------------------------------------------
# Step 1.5: List Macros 
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41034180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.6: Review returned report and make sure MACRO M1 is listed.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.7: Describe Macro M1
#------------------------------------------------------------------------------
c11541094c83054125478145a401410501
WAIT 1

#------------------------------------------------------------------------------
# Step 1.8: Make sure M1 was described correctly.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.9: Define SRL S1 to run every time V5 >= 2 up to 3 times. 
#------------------------------------------------------------------------------
# A1 ARI = 0xa801410101
# Start = 0
# Expr = [V5, 2, >=]
# MaxEval = 1000
# Count = 3
# Action = [M1]
#------------------------------------------------------------------------------
c115410b583a8905472416261616251245a80141010141005554148345ac0141050142430248c5181842182f4180431903e84103478145a40141050143625331
WAIT 1

#------------------------------------------------------------------------------
# Step 1.10: List known rules
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41044180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.11: Ensure that S1 is there.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.12: Describe SRL1
#------------------------------------------------------------------------------
c115410d4c83054125478145a801410101
WAIT 1

#------------------------------------------------------------------------------
# Step 1.13: Ensure that S1 matches description
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.14: Set TBR T1 to run every 20 seconds 6 times that will
# run the command: V5 = V5 + 1 which is: STOR(V5, {(UINT), V5 1 +})
#------------------------------------------------------------------------------
# T5 ARI = 0xab01410501
# T5 Start = 0
# T5 Period = 20
# T5 Count = 6
#------------------------------------------------------------------------------
c115410a584488054624161616251245ab014105014100411441065829815826c115410e5820840542242645ac014105015453148345ac0141050142430147c518184101418043625435
WAIT 1

#------------------------------------------------------------------------------
# Step 1.15: Describe T1 and make sure it is correct.
#------------------------------------------------------------------------------

c115410d4c83054125478145ab01410501
WAIT 1

#------------------------------------------------------------------------------
# Step 1.16: Verify S1 runs 3 times, approximately every 40 seconds.
#------------------------------------------------------------------------------

WAIT 170

#------------------------------------------------------------------------------
# Step 1.17: Inspect ADM reports for correct # TBR and SBR counts.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.18: List known rules and verify S1 and T1 are no longer listed.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41044180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.19: Delete S1. i.e. show no issue with deleting a deleted SBR
#------------------------------------------------------------------------------
c115410c4c83054125478145a801410101
WAIT 1


#------------------------------------------------------------------------------
# Step 1.20: Restart Agent and verify only 1 Var and 1 Macro restore.
#------------------------------------------------------------------------------

