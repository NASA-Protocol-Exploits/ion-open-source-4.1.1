# Standard Reports.
#

###################################################
# Test Case 1 Generate Reports.
###################################################
 
#------------------------------------------------------------------------------
# Step 1.1: Generate Agent ADM Full Report.
#------------------------------------------------------------------------------
c11541054f840542252347814587181941004180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.2: Verify ADM report received and correct.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.3 Generate BP Report
#------------------------------------------------------------------------------
c11541054f840542252347814587182d41004180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.4: Verify BP Report received and correct.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.5: Generate ADM Report and BP Report Concurrently.
#------------------------------------------------------------------------------
c11541055584054225234d824587181941004587182d41004180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.6: Verify both reports received and correct.
#------------------------------------------------------------------------------

###################################################
# Test Case 2: Generate parameterized reports
###################################################

#------------------------------------------------------------------------------
# Step 2.1: Generate Endpoint report for endpoint 
#------------------------------------------------------------------------------
# For ipn:1.1
c1154105581d8405422523558153c7182d41014d83054112486769706e3a312e314180
WAIT 1


#------------------------------------------------------------------------------
# Step 2.2: Verify endpoint report received for selected endpoint
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 2.3 Generate Endpoint report for endpoints
#------------------------------------------------------------------------------
# For  "ipn:1.0", "ipn:1.1", and "ipn:1.2"
#------------------------------------------------------------------------------
c115410558468405422523583d8353c7182d41014d83054112486769706e3a312e3053c7182d41014d83054112486769706e3a312e3153c7182d41014d83054112486769706e3a312e324180
WAIT 1


###################################################
# Test Case 3: Report on basic elements 
###################################################

#------------------------------------------------------------------------------
# Step 3.1: Generate Report that has specified EDD in it.
# EDD selected is NUM_TBL_TPLS 
#------------------------------------------------------------------------------
c11541054e8405422523468144821641014180
WAIT 1

#------------------------------------------------------------------------------
# Step 3.2: Verify report received and correct.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 3.3: Generate Report that has specified VAR in it.
# VAR selected is NUM_RULES
#------------------------------------------------------------------------------
c11541054f84054225234781458c181d41004180
WAIT 1

#------------------------------------------------------------------------------
# Step 3.4: Verify report received and correct.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 3.5 Generate two report at once: with EDD and VAR in it.
#------------------------------------------------------------------------------
# EDD selected is NUM_TBL_TPLS
# VAR selected is NUM_RULES
#------------------------------------------------------------------------------
c11541055484054225234c824482164101458c181d41004180
WAIT 1

#------------------------------------------------------------------------------
# Step 3.6: Verify report received and correct
#------------------------------------------------------------------------------


###################################################
# Test Case 4: Report templates 
###################################################

#------------------------------------------------------------------------------
# Step 4.1: Add a report template (R1)
#             NN: 1 ISS: 1 Name: 1.
#             (0xa701410101)
#------------------------------------------------------------------------------
c11541025818840542242545a7014101014c824482164101458c181d4100
WAIT 1

#------------------------------------------------------------------------------
# Step 4.2: Describe Report
#------------------------------------------------------------------------------
c11541044c83054125478145a701410101
WAIT 1

#------------------------------------------------------------------------------
# Step 4.3: Reboot Manager and verify report loads from SDR.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.4: Dump RPTT table.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41024180
WAIT 1

#------------------------------------------------------------------------------
# Step 4.5: Request Report R1
#------------------------------------------------------------------------------
c11541054f8405422523478145a7014101014180
WAIT 1

#------------------------------------------------------------------------------
# Step 4.6: Reboot Agent and make sure R1 is read back from SDR.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.7: Dump RPTT table and make sure R1 still exists.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41024180
WAIT 1

#------------------------------------------------------------------------------
# Step 4.8: Delete R1
#------------------------------------------------------------------------------
c11541034c83054125478145a701410101
WAIT 1

#------------------------------------------------------------------------------
# Step 4.9: Dump RPTT table and make sure R1 is gone.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41024180
WAIT 1

#------------------------------------------------------------------------------
# Step 4.10: Reboot Agent and make sure R1 does not come back.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 4.11: Dump RPTT table and make sure R1 is gone.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41024180
WAIT 1

#------------------------------------------------------------------------------
# Step 4.12: Reboot Mgr and make sure R1 does not come back.
#------------------------------------------------------------------------------


###################################################
# Test Case 5: Describe Report
###################################################

#------------------------------------------------------------------------------
# Step 5.1: Describe the AMP Agent FUll report.
#------------------------------------------------------------------------------
c11541044c830541254781458718194100
WAIT 1




# Test Set 2: Variables
#

###############################################################################
# TC 1 Test Basic Variable Operations
###############################################################################
# Generate basic variables in the AMP.
#
###############################################################################

#------------------------------------------------------------------------------
# Step 1.1: Define UINT V1 as "2 + 2"
#------------------------------------------------------------------------------
# Note: V1 ARI will be 0x8c18644101 
#------------------------------------------------------------------------------
c11541005820850543242611458c186441015150148342430242430247c51818410141804114
WAIT 1

#------------------------------------------------------------------------------
# Step 1.2: List VARs on the agent and confirm that V1 is listed.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41014180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.3: Generate a report for V1 and confirm it has value UINT 4
#------------------------------------------------------------------------------
c11541054f84054225234781458c186441014180
WAIT 1


#------------------------------------------------------------------------------
# Step 1.4: Restart the Agent. 
#------------------------------------------------------------------------------


#------------------------------------------------------------------------------
# Step 1.5: List VARs on the agent and confirm that V1 is still listed.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41014180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.6: Generate a report for V1 and confirm it still has value UINT 4
#------------------------------------------------------------------------------
c11541054f84054225234781458c186441014180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.7 Delete V1
#------------------------------------------------------------------------------
c11541014c830541254781458c18644101
WAIT 1


#------------------------------------------------------------------------------
# Step 1.8: List VARs on the agent and confirm that V1 is NOT listed.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41014180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.9: Generate a report for V1 and confirm it is not reported.
#------------------------------------------------------------------------------
c11541054f84054225234781458c186441014180
WAIT 1


#------------------------------------------------------------------------------
# Step 1.10: Restart the Agent. 
#------------------------------------------------------------------------------


#------------------------------------------------------------------------------
# Step 1.11: List VARs on the agent and confirm that V1 is NOT listed.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41014180
WAIT 1


#------------------------------------------------------------------------------
# Step 1.12: Generate a report for V1 and confirm it is not reported.
#------------------------------------------------------------------------------
c11541054f84054225234781458c186441014180
WAIT 1



###############################################################################
# Test Case 2.2: Complex Variables
###############################################################################
# uint V2 = 4;         // Test that V2 = 4.
# expr V3 = V2 + 1;     
# uint V4 = eval(V3);  // Test that V4 = 5.
# V2 = V4;             // Test that V2 = 5.
# V4 = eval(V3);       // Test that V4 = 6.
#
# V2 ARI = 0xac01410201
# V3 ARI = 0xac01410301
# V4 ARI = 0xac01410401
###############################################################################

#------------------------------------------------------------------------------
# Step 2.2.1: Define UINT V2 as "4"
#------------------------------------------------------------------------------
c11541005585054324261145ac01410201464514814243044114
WAIT 1

#------------------------------------------------------------------------------
# Step 2.2.2: Define EXPR V3 as "V2 + 1"
#------------------------------------------------------------------------------
# EXPR = [UINT, [V3, 1, plusUINT]]
#------------------------------------------------------------------------------
c1154100582385054324261145ac014103015453148345ac0141020142430147c51818410141804126
WAIT 1

#------------------------------------------------------------------------------
# Step 2.2.3: Define UINT V4 as having an initializing expression of {V3}
#------------------------------------------------------------------------------
c1154100581885054324261145ac014104014948148145ac014103014114
WAIT 1

#------------------------------------------------------------------------------
# Step 2.2.4: Define custom report R1 = {V2, V3, V4}
#------------------------------------------------------------------------------
# R1 ARI = 0xa701410501
#------------------------------------------------------------------------------
c1154102581f840542242545a701410501538345ac0141020145ac0141030145ac01410401
WAIT 1

#------------------------------------------------------------------------------
# Step 2.2.5: Generate Report R1 and verify values are {4,EXPR,5}
#------------------------------------------------------------------------------
c11541054f8405422523478145a7014105014180
WAIT 1

#------------------------------------------------------------------------------
# Step 2.2.6: STORE(V2, V4)  - V2 = V4
#------------------------------------------------------------------------------
c115410e55840542242645ac014102014948148145ac01410401
WAIT 1

#------------------------------------------------------------------------------
# Step 2.2.7: STORE(V4, V3) - V4 = expr_eval(V3)
#------------------------------------------------------------------------------
c115410e55840542242645ac014104014948148145ac01410301
WAIT 1


#------------------------------------------------------------------------------
# Step 2.2.8: Generate Report R1 and verify values are {5,EXPR,6}
#------------------------------------------------------------------------------
c11541054f8405422523478145a7014105014180
WAIT 1



# Create a Macro that dumps an AMP full report. Clears the AMP report. Produces new Report.
# Type: Macro. NN=1, ISS=1, Name=1
# 0xa401410101
#
c1154107584285054312242543624d3145a40141010158308354c11541054f840542252347814587181941004180448115410f54c11541054f840542252347814587181941004180
WAIT 1

#Describe Macro
c11541094c83054125478145a401410101
WAIT 1

# Reboot manager and see if macro reloads.

# Request table of known macros.
#
c11541064f84054225234781458a181b41034180
WAIT 1

# Reboot agent and see if macro comes back.

# Request table of known macros. Make sure it is still there.
c11541064f84054225234781458a181b41034180
WAIT 1

# Delete Macro
c11541084c83054125478145a401410101
WAIT 1

# Request table of known macros and make sure macro is no longer listed.

# Reboot agent and make sure macro doesn't come back.

# Request table of known macros. Make sure it is no longer there.
c11541064f84054225234781458a181b41034180





# Test Set 3: Time-Based Rule Production.
#

###############################################################################
# TC 3.1 Generate Reports to a schedule.
###############################################################################
# This test will cause an AGENT FULL report to be generated
# 5 times at intervals of 5 seconds each.
#
###############################################################################


#------------------------------------------------------------------------------
# Step 3.1.1: Build the TBR to report on the AGENT Full Report.
# NN: 1, ISS: 1, Name: 1
#------------------------------------------------------------------------------
# NOTE: The TRL will have an ID of: 0xab01410101
# START: 0
# PERIOD: 5
# COUNT: 5
# Action: {GEN_RPT({FULL_REPORT}, 0)}
#------------------------------------------------------------------------------
c115410a583588054624161616251245ab01410101410041054105568154c11541054f840542252347814587181941004180486747656e52707473
WAIT 1

#------------------------------------------------------------------------------
# Step 3.1.2: Verify that 5 reports are received approximately 
# 5 seconds apart (variance up to 1 second between individual reports
# are within tolerance due to the 1Hz rate of the agent autonomy
# engine. 
#------------------------------------------------------------------------------
 
WAIT 30
 

###############################################################################
# TC 3.2: Manipulate TBRs.
###############################################################################
# Interrupt a running TBR
###############################################################################

#------------------------------------------------------------------------------
# Step 3.2.1: Define a TRL that will generate an AGENT FULL REPORT every 30
# seconds 100 times.
#------------------------------------------------------------------------------
# TBR 2 will have an Id of: 0xab01410201
#------------------------------------------------------------------------------
c115410a583488054624161616251245ab01410201410042181e421864568154c11541054f840542252347814587181941004180456454425232
WAIT 1


#------------------------------------------------------------------------------
# Step 3.2.2: List TBRs on the agent. 
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41044180
WAIT 1


#------------------------------------------------------------------------------
# Step 3.2.3: Verify TBR 2 is listed in the report.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 3.2.4: Describe TBR 2.
#------------------------------------------------------------------------------
c115410d4c83054125478145ab01410201
WAIT 1

#------------------------------------------------------------------------------
# Step 3.2.5: Verify the description matches the definition.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 3.2.6: Delete the TRL.
#------------------------------------------------------------------------------
c115410c4c83054125478145ab01410201
WAIT 1


#------------------------------------------------------------------------------
# Step 3.2.7: Verify no reports received after TRL deleted.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 3.2.8: List TBRs on the agent.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41044180
WAIT 1

#------------------------------------------------------------------------------
# Step 3.2.9: Verify TBR2 not shown in list.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 3.2.10: Describe TBR 2 from the agent.
#------------------------------------------------------------------------------
c115410d4c83054125478145ab01410201
WAIT 1

#------------------------------------------------------------------------------
# Step 3.2.11: Verify TBR not there to be described.
#------------------------------------------------------------------------------


###############################################################################
# TC 3.3: Run parameterized macro by TBR
###############################################################################
# 
###############################################################################

#------------------------------------------------------------------------------
# Step 3.3.1: Define TBR T7 to run Agent Macro USER_DESC 1 time wither period 5.
#------------------------------------------------------------------------------
# T7 ARI: 0xab01410701
#------------------------------------------------------------------------------
c115410a583888054624161616251245ab01410701410041014101581d81581ac41741005584054225254781458718194100478145ab0141070143625437
WAIT 1

#------------------------------------------------------------------------------
# Step 3.3.2: Read the returned report and make sure parms were correct.
#------------------------------------------------------------------------------


# State-Based Rule Production.
#

###############################################################################
# TC 1 Generate Reports based on a variable.
###############################################################################
# This test will cause an Agent FULL REPORT to be generated
# up to 5 times whenever Variable V5 == 1.
###############################################################################


#------------------------------------------------------------------------------
# Step 1.1: Define UINT V5 = 0.
#------------------------------------------------------------------------------
# V5 ARI = 0xac01410501
#------------------------------------------------------------------------------
c11541005585054324261145ac01410501464514814243004114
WAIT 1

#------------------------------------------------------------------------------
# Step 1.2: Retrieve value of V5 in a report.
#------------------------------------------------------------------------------
c11541054f8405422523478145ac014105014180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.3: Confirm value of V5 is 0.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.4: Define Macro M1 generate an agent FULL_REPORT and reset V5 = 0
#------------------------------------------------------------------------------
# Macro = [genRpt([FULL_REPORT], 0), Store(V5, 0)]
# M1 ARI = 0xa401410501
#------------------------------------------------------------------------------
c115410758418505431224254463746d7045a401410501582e8254c11541054f84054225234781458718194100418057c115410e52840542242645ac0141050146451481424300
WAIT 1

#------------------------------------------------------------------------------
# Step 1.5: List Macros 
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41034180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.6: Review returned report and make sure MACRO M1 is listed.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.7: Describe Macro M1
#------------------------------------------------------------------------------
c11541094c83054125478145a401410501
WAIT 1

#------------------------------------------------------------------------------
# Step 1.8: Make sure M1 was described correctly.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.9: Define SRL S1 to run every time V5 >= 2 up to 3 times. 
#------------------------------------------------------------------------------
# A1 ARI = 0xa801410101
# Start = 0
# Expr = [V5, 2, >=]
# MaxEval = 1000
# Count = 3
# Action = [M1]
#------------------------------------------------------------------------------
c115410b583a8905472416261616251245a80141010141005554148345ac0141050142430248c5181842182f4180431903e84103478145a40141050143625331
WAIT 1

#------------------------------------------------------------------------------
# Step 1.10: List known rules
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41044180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.11: Ensure that S1 is there.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.12: Describe SRL1
#------------------------------------------------------------------------------
c115410d4c83054125478145a801410101
WAIT 1

#------------------------------------------------------------------------------
# Step 1.13: Ensure that S1 matches description
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.14: Set TBR T1 to run every 20 seconds 6 times that will
# run the command: V5 = V5 + 1 which is: STOR(V5, {(UINT), V5 1 +})
#------------------------------------------------------------------------------
# T5 ARI = 0xab01410501
# T5 Start = 0
# T5 Period = 20
# T5 Count = 6
#------------------------------------------------------------------------------
c115410a584488054624161616251245ab014105014100411441065829815826c115410e5820840542242645ac014105015453148345ac0141050142430147c518184101418043625435
WAIT 1

#------------------------------------------------------------------------------
# Step 1.15: Describe T1 and make sure it is correct.
#------------------------------------------------------------------------------

c115410d4c83054125478145ab01410501
WAIT 1

#------------------------------------------------------------------------------
# Step 1.16: Verify S1 runs 3 times, approximately every 40 seconds.
#------------------------------------------------------------------------------

WAIT 170

#------------------------------------------------------------------------------
# Step 1.17: Inspect ADM reports for correct # TBR and SBR counts.
#------------------------------------------------------------------------------

#------------------------------------------------------------------------------
# Step 1.18: List known rules and verify S1 and T1 are no longer listed.
#------------------------------------------------------------------------------
c11541064f84054225234781458a181b41044180
WAIT 1

#------------------------------------------------------------------------------
# Step 1.19: Delete S1. i.e. show no issue with deleting a deleted SBR
#------------------------------------------------------------------------------
c115410c4c83054125478145a801410101
WAIT 1


#------------------------------------------------------------------------------
# Step 1.20: Restart Agent and verify only 1 Var and 1 Macro restore.
#------------------------------------------------------------------------------

