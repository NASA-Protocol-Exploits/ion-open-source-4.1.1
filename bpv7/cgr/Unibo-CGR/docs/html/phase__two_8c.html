<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Unibo-CGR: core/cgr/phase_two.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Unibo-CGR
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4270bfced15e0e73154b13468c7c9ad9.html">core</a></li><li class="navelem"><a class="el" href="dir_6e1c4bcf48b7d5e2618e8d262a3dd3f7.html">cgr</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">phase_two.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This file provides the implementation of the CGR's phase two: in this phase we determine who are the viable routes for the forwarding of the bundle.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_phase_two_s_a_p.html">PhaseTwoSAP</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to keep in one place all the data used by phase two.  <a href="struct_phase_two_s_a_p.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:aad6dd0bba749083683c6d79d30324390"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#aad6dd0bba749083683c6d79d30324390">PhaseTwoRouteFlag</a> { <a class="el" href="phase__two_8c.html#aad6dd0bba749083683c6d79d30324390a3baf7711e0f3b3a8f86432c2b99ea1c1">DiscardedRoute</a> = 0, 
<a class="el" href="phase__two_8c.html#aad6dd0bba749083683c6d79d30324390a8e805dfbf3a4fa729c804d41999d5406">CandidateRoute</a> = 1
 }</td></tr>
<tr class="separator:aad6dd0bba749083683c6d79d30324390"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2053e28a3f1ee3150bd048d6a1a15775"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="struct_phase_two_s_a_p.html">PhaseTwoSAP</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a2053e28a3f1ee3150bd048d6a1a15775">get_phase_two_sap</a> (<a class="el" href="struct_phase_two_s_a_p.html">PhaseTwoSAP</a> *newSap)</td></tr>
<tr class="memdesc:a2053e28a3f1ee3150bd048d6a1a15775"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the <a class="el" href="struct_phase_two_s_a_p.html" title="Used to keep in one place all the data used by phase two.">PhaseTwoSAP</a> with all the values used by phase two during the current call.  <a href="phase__two_8c.html#a2053e28a3f1ee3150bd048d6a1a15775">More...</a><br /></td></tr>
<tr class="separator:a2053e28a3f1ee3150bd048d6a1a15775"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5450d4081211d44ddcb642b62a08717"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#af5450d4081211d44ddcb642b62a08717">initialize_phase_two</a> ()</td></tr>
<tr class="memdesc:af5450d4081211d44ddcb642b62a08717"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the data used by the phase two.  <a href="phase__two_8c.html#af5450d4081211d44ddcb642b62a08717">More...</a><br /></td></tr>
<tr class="separator:af5450d4081211d44ddcb642b62a08717"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d8008e926aba4248946a793115e385d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a8d8008e926aba4248946a793115e385d">destroy_phase_two</a> ()</td></tr>
<tr class="memdesc:a8d8008e926aba4248946a793115e385d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Deallocate all the memory allocated by the phase two.  <a href="phase__two_8c.html#a8d8008e926aba4248946a793115e385d">More...</a><br /></td></tr>
<tr class="separator:a8d8008e926aba4248946a793115e385d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a73c02ea4a81583e33891590bf0e9cf4a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a73c02ea4a81583e33891590bf0e9cf4a">reset_phase_two</a> ()</td></tr>
<tr class="memdesc:a73c02ea4a81583e33891590bf0e9cf4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reset the routes list, so at the end it will be empty.  <a href="phase__two_8c.html#a73c02ea4a81583e33891590bf0e9cf4a">More...</a><br /></td></tr>
<tr class="separator:a73c02ea4a81583e33891590bf0e9cf4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39f09c16f15afae99d155a2e078446cb"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a39f09c16f15afae99d155a2e078446cb">isExcluded</a> (unsigned long long target, <a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> <a class="el" href="interface__unibocgr__dtn2_8cc.html#ac166cd469ad1aa61963b9b9c28372dc9">excludedNeighbors</a>)</td></tr>
<tr class="memdesc:a39f09c16f15afae99d155a2e078446cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if "target" is an excluded neighbor.  <a href="phase__two_8c.html#a39f09c16f15afae99d155a2e078446cb">More...</a><br /></td></tr>
<tr class="separator:a39f09c16f15afae99d155a2e078446cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3266c2b610c3ae185e1ca21012259040"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a3266c2b610c3ae185e1ca21012259040">reached_neighbors_limit</a> (long unsigned int neighborsFound, long unsigned int suppressedFound, long unsigned int neighborsLimit, long unsigned int maxNeighborsNumber)</td></tr>
<tr class="memdesc:a3266c2b610c3ae185e1ca21012259040"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if we found a candidate route for at least N neighbors (or all). So if we reached the limit.  <a href="phase__two_8c.html#a3266c2b610c3ae185e1ca21012259040">More...</a><br /></td></tr>
<tr class="separator:a3266c2b610c3ae185e1ca21012259040"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaacb87a7894211d1b1b01da87dca277c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#aaacb87a7894211d1b1b01da87dca277c">computeResidualBacklog</a> (unsigned long regionNbr, time_t current_time, unsigned long long localNode, <a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *route, <a class="el" href="struct_cgr_scalar.html">CgrScalar</a> *allotment, <a class="el" href="struct_cgr_scalar.html">CgrScalar</a> *volume, <a class="el" href="struct_cgr_scalar.html">CgrScalar</a> *residualBacklog)</td></tr>
<tr class="memdesc:aaacb87a7894211d1b1b01da87dca277c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the residual backlog for the neighbor (identified from the first hop destination node of the route) and some other fields to manage the potential overbooking (route-&gt;protected, allotment and volume)  <a href="phase__two_8c.html#aaacb87a7894211d1b1b01da87dca277c">More...</a><br /></td></tr>
<tr class="separator:aaacb87a7894211d1b1b01da87dca277c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1442b7ced755cbfc9c23a94db9e30b6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#ab1442b7ced755cbfc9c23a94db9e30b6">computeEffectiveVolumeLimit</a> (<a class="el" href="struct_contact.html">Contact</a> *contact, <a class="el" href="bundles_8h.html#a315655b1bb5848c063491adffde62b15">Priority</a> priority, time_t firstByteTransmitTime, <a class="el" href="list__type_8h.html#a0fb2219714cd80537f235ceb3984f7d9">ListElt</a> *elt, double *effectiveVolumeLimit)</td></tr>
<tr class="memdesc:ab1442b7ced755cbfc9c23a94db9e30b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute the effective volume limit, algorithm explained at: SABR 3.2.6.8.9.  <a href="phase__two_8c.html#ab1442b7ced755cbfc9c23a94db9e30b6">More...</a><br /></td></tr>
<tr class="separator:ab1442b7ced755cbfc9c23a94db9e30b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9b6bde3e2b540750c9606562b5b5c26"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#ad9b6bde3e2b540750c9606562b5b5c26">computeExpectedBundleDeliveryTime</a> (time_t current_time, <a class="el" href="struct_cgr_bundle.html">CgrBundle</a> *bundle, <a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *route, <a class="el" href="struct_cgr_scalar.html">CgrScalar</a> *residualBacklog, time_t *lastByteArrivalTime)</td></tr>
<tr class="memdesc:ad9b6bde3e2b540750c9606562b5b5c26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the route is viable for the forwarding of the bundle, compute the ETO, compute the PBAT and compute the RVL.  <a href="phase__two_8c.html#ad9b6bde3e2b540750c9606562b5b5c26">More...</a><br /></td></tr>
<tr class="separator:ad9b6bde3e2b540750c9606562b5b5c26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af0fdd1e16bf8bd7fa9ecb9aaf55924d0"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#af0fdd1e16bf8bd7fa9ecb9aaf55924d0">computePBAT</a> (time_t current_time, unsigned long long localNode, <a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *route, <a class="el" href="struct_cgr_bundle.html">CgrBundle</a> *bundle)</td></tr>
<tr class="memdesc:af0fdd1e16bf8bd7fa9ecb9aaf55924d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the route is viable for the forwarding of the bundle, compute the ETO, computed the PBAT and check for potential overbooking.  <a href="phase__two_8c.html#af0fdd1e16bf8bd7fa9ecb9aaf55924d0">More...</a><br /></td></tr>
<tr class="separator:af0fdd1e16bf8bd7fa9ecb9aaf55924d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acecc44affaf421e9b11b230103932486"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#acecc44affaf421e9b11b230103932486">insert_route_in_subset_computed_routes</a> (<a class="el" href="struct_neighbor.html">Neighbor</a> *neighbor, <a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *newSubsetRoute)</td></tr>
<tr class="memdesc:acecc44affaf421e9b11b230103932486"><td class="mdescLeft">&#160;</td><td class="mdescRight">Insert a computed route into subset of computed routes that phase two recommends to phase one for Yen's algorithm.  <a href="phase__two_8c.html#acecc44affaf421e9b11b230103932486">More...</a><br /></td></tr>
<tr class="separator:acecc44affaf421e9b11b230103932486"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8a6433f524a83920c94c1365997be59"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#af8a6433f524a83920c94c1365997be59">remove_neighbor_from_subset_computed_routes</a> (unsigned long long newNeighbor)</td></tr>
<tr class="memdesc:af8a6433f524a83920c94c1365997be59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove all routes (with the neighbor passed as argument) from the subset.  <a href="phase__two_8c.html#af8a6433f524a83920c94c1365997be59">More...</a><br /></td></tr>
<tr class="separator:af8a6433f524a83920c94c1365997be59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1e6d2a368b05ecf144a24ed37db01266"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a1e6d2a368b05ecf144a24ed37db01266">suppress_neighbor</a> (<a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> suppressedNeighbors, unsigned long long *neighbor)</td></tr>
<tr class="memdesc:a1e6d2a368b05ecf144a24ed37db01266"><td class="mdescLeft">&#160;</td><td class="mdescRight">Add the ipn node in the suppressedNeighbors list, only if it isn't already present.  <a href="phase__two_8c.html#a1e6d2a368b05ecf144a24ed37db01266">More...</a><br /></td></tr>
<tr class="separator:a1e6d2a368b05ecf144a24ed37db01266"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d3984089e5ee430ea79fcb591f4dfa7"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a8d3984089e5ee430ea79fcb591f4dfa7">suppress_destination_excluded_neighbors</a> (<a class="el" href="nodes_8h.html#ac09cf950484bd9550d14d602b0e5e7fb">Node</a> *destination, <a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> suppressedNeighbors, <a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> <a class="el" href="interface__unibocgr__dtn2_8cc.html#ac166cd469ad1aa61963b9b9c28372dc9">excludedNeighbors</a>)</td></tr>
<tr class="memdesc:a8d3984089e5ee430ea79fcb591f4dfa7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Suppress only the neighbors to reach destination that are in the excludedNeighbors.  <a href="phase__two_8c.html#a8d3984089e5ee430ea79fcb591f4dfa7">More...</a><br /></td></tr>
<tr class="separator:a8d3984089e5ee430ea79fcb591f4dfa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad0548bf74d27974e3ce141b09ef4fb4f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#ad0548bf74d27974e3ce141b09ef4fb4f">update_neighbors_counter</a> (<a class="el" href="struct_neighbor.html">Neighbor</a> *neighbor, <a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *newCandidateRoute)</td></tr>
<tr class="memdesc:ad0548bf74d27974e3ce141b09ef4fb4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update the neighborsFound counter used during the current call.  <a href="phase__two_8c.html#ad0548bf74d27974e3ce141b09ef4fb4f">More...</a><br /></td></tr>
<tr class="separator:ad0548bf74d27974e3ce141b09ef4fb4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5100099dcb783b0ad89b8e65785cf6"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a3e5100099dcb783b0ad89b8e65785cf6">phase_one_conversation_management</a> (<a class="el" href="phase__two_8c.html#aad6dd0bba749083683c6d79d30324390">PhaseTwoRouteFlag</a> routeFlag, <a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *route, long unsigned int neighbors_limit, long unsigned int max_neighbors_number)</td></tr>
<tr class="memdesc:a3e5100099dcb783b0ad89b8e65785cf6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manage the feedback that phase two provides to phase one.  <a href="phase__two_8c.html#a3e5100099dcb783b0ad89b8e65785cf6">More...</a><br /></td></tr>
<tr class="separator:a3e5100099dcb783b0ad89b8e65785cf6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76a36930c067205b26632404c84e283d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a76a36930c067205b26632404c84e283d">lowDlvConfidence</a> (float bundleDlvConfidence, float routeArrivalConfidence)</td></tr>
<tr class="memdesc:a76a36930c067205b26632404c84e283d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the route arrival confidence add to the bundle's delivery confidence a confidence less than the MIN_CONFIDENCE_IMPROVEMENT.  <a href="phase__two_8c.html#a76a36930c067205b26632404c84e283d">More...</a><br /></td></tr>
<tr class="separator:a76a36930c067205b26632404c84e283d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5d6a27655795b8e3cfebece1f4a1dbe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#ac5d6a27655795b8e3cfebece1f4a1dbe">checkRoute</a> (time_t current_time, unsigned long long localNode, <a class="el" href="struct_cgr_bundle.html">CgrBundle</a> *bundle, <a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> <a class="el" href="interface__unibocgr__dtn2_8cc.html#ac166cd469ad1aa61963b9b9c28372dc9">excludedNeighbors</a>, <a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *route)</td></tr>
<tr class="memdesc:ac5d6a27655795b8e3cfebece1f4a1dbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the route is viable for the forwarding of the bundle.  <a href="phase__two_8c.html#ac5d6a27655795b8e3cfebece1f4a1dbe">More...</a><br /></td></tr>
<tr class="separator:ac5d6a27655795b8e3cfebece1f4a1dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e7a5ca4e6091f6e069317d3e4e65c31"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="phase__two_8c.html#a8e7a5ca4e6091f6e069317d3e4e65c31">getCandidateRoutes</a> (<a class="el" href="nodes_8h.html#ac09cf950484bd9550d14d602b0e5e7fb">Node</a> *terminusNode, <a class="el" href="struct_cgr_bundle.html">CgrBundle</a> *bundle, <a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> <a class="el" href="interface__unibocgr__dtn2_8cc.html#ac166cd469ad1aa61963b9b9c28372dc9">excludedNeighbors</a>, <a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> computedRoutes, <a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> *subsetComputedRoutes, long unsigned int *missingNeighbors, <a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> *candidateRoutes)</td></tr>
<tr class="memdesc:a8e7a5ca4e6091f6e069317d3e4e65c31"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check all the computed routes and populate the candidate routes list.  <a href="phase__two_8c.html#a8e7a5ca4e6091f6e069317d3e4e65c31">More...</a><br /></td></tr>
<tr class="separator:a8e7a5ca4e6091f6e069317d3e4e65c31"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This file provides the implementation of the CGR's phase two: in this phase we determine who are the viable routes for the forwarding of the bundle. </p>
<p>We check each computed route (phase one's output). The output of this phase is the candidate routes list.</p>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright (c) 2020, Alma Mater Studiorum, University of Bologna, All rights reserved.</dd></dl>
<dl class="section user"><dt>License</dt><dd></dd></dl>
<p>This file is part of Unibo-CGR. <br  />
 <br  />
 Unibo-CGR is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version. <br  />
 Unibo-CGR is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details. <br  />
 <br  />
 You should have received a copy of the GNU General Public License along with Unibo-CGR. If not, see <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>.</p>
<dl class="section author"><dt>Author</dt><dd>Lorenzo Persampieri, <a href="#" onclick="location.href='mai'+'lto:'+'lor'+'en'+'zo.'+'pe'+'rsa'+'mp'+'ier'+'i@'+'stu'+'di'+'o.u'+'ni'+'bo.'+'it'; return false;">loren<span style="display: none;">.nosp@m.</span>zo.p<span style="display: none;">.nosp@m.</span>ersam<span style="display: none;">.nosp@m.</span>pier<span style="display: none;">.nosp@m.</span>i@stu<span style="display: none;">.nosp@m.</span>dio.<span style="display: none;">.nosp@m.</span>unibo<span style="display: none;">.nosp@m.</span>.it</a></dd></dl>
<dl class="section user"><dt>Supervisor</dt><dd>Carlo Caini, <a href="#" onclick="location.href='mai'+'lto:'+'car'+'lo'+'.ca'+'in'+'i@u'+'ni'+'bo.'+'it'; return false;">carlo<span style="display: none;">.nosp@m.</span>.cai<span style="display: none;">.nosp@m.</span>ni@un<span style="display: none;">.nosp@m.</span>ibo.<span style="display: none;">.nosp@m.</span>it</a> </dd></dl>
</div><h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="aad6dd0bba749083683c6d79d30324390"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad6dd0bba749083683c6d79d30324390">&#9670;&nbsp;</a></span>PhaseTwoRouteFlag</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="phase__two_8c.html#aad6dd0bba749083683c6d79d30324390">PhaseTwoRouteFlag</a></td>
        </tr>
      </table>
</div><div class="memdoc">
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="aad6dd0bba749083683c6d79d30324390a3baf7711e0f3b3a8f86432c2b99ea1c1"></a>DiscardedRoute&#160;</td><td class="fielddoc"></td></tr>
<tr><td class="fieldname"><a id="aad6dd0bba749083683c6d79d30324390a8e805dfbf3a4fa729c804d41999d5406"></a>CandidateRoute&#160;</td><td class="fielddoc"></td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="ac5d6a27655795b8e3cfebece1f4a1dbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5d6a27655795b8e3cfebece1f4a1dbe">&#9670;&nbsp;</a></span>checkRoute()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int checkRoute </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>current_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long&#160;</td>
          <td class="paramname"><em>localNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_cgr_bundle.html">CgrBundle</a> *&#160;</td>
          <td class="paramname"><em>bundle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a>&#160;</td>
          <td class="paramname"><em>excludedNeighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *&#160;</td>
          <td class="paramname"><em>route</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if the route is viable for the forwarding of the bundle. </p>
<dl class="section user"><dt>Function Name:</dt><dd>checkRoute</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success case: The route is viable for the forwarding of the bundle </td></tr>
    <tr><td class="paramname">-1</td><td>The route was already checked </td></tr>
    <tr><td class="paramname">-2</td><td>MWITHDRAW error </td></tr>
    <tr><td class="paramname">-3</td><td>Route not viable: Terminated route SABR 2.3.2.1 </td></tr>
    <tr><td class="paramname">-4</td><td>Route not viable: Best-case delivery time is after than the bundle's deadline SABR 3.2.6.9 a) </td></tr>
    <tr><td class="paramname">-5</td><td>Route not viable: (no SABR) The first contact has a confidence less than 1.0 (used in ION) </td></tr>
    <tr><td class="paramname">-6</td><td>Route not viable: (no SABR) The route adds to the bundle's delivery confidence a not considerable confidence (used in ION) </td></tr>
    <tr><td class="paramname">-7</td><td>Route not viable: The neighbor is the local node but the local node isn't the bundle's destination node SABR 3.2.6.9 c) </td></tr>
    <tr><td class="paramname">-8</td><td>Route not viable: The neighbor is in the excluded nodes list SABR 3.2.6.9 b) </td></tr>
    <tr><td class="paramname">-9</td><td>Route not viable: PBAT computation error</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">current_time</td><td>The time used during the call </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">localNode</td><td>The own node </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*bundle</td><td>The bundle that has to be forwarded </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">excludedNeighbors</td><td>The excluded nodes list SABR 3.2.5.2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*route</td><td>The route to check</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>bundle doesn't have to be NULL </dd>
<dd>
excludedNeighbors doesn't have to be NULL </dd>
<dd>
route doesn't have to be NULL</dd></dl>
<dl class="section user"><dt>Notes:</dt><dd><ol type="1">
<li>In success case the following route's fields will be updated:<ul>
<li>eto</li>
<li>pbat</li>
<li>routeVolumeLimit</li>
<li>bundleEVC</li>
<li>owltSum</li>
<li>arrivalTime</li>
<li>checkValue</li>
</ul>
</li>
<li>In success case: if CGR_AVOID_LOOP is enabled and the neighbor is in the bundle's loopNodes list we add the neighbor to the phase one's failedNeighbors list, in that case the route's checkValue field will be updated to CLOSING_LOOP.</li>
</ol>
</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="ab1442b7ced755cbfc9c23a94db9e30b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1442b7ced755cbfc9c23a94db9e30b6">&#9670;&nbsp;</a></span>computeEffectiveVolumeLimit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int computeEffectiveVolumeLimit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_contact.html">Contact</a> *&#160;</td>
          <td class="paramname"><em>contact</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="bundles_8h.html#a315655b1bb5848c063491adffde62b15">Priority</a>&#160;</td>
          <td class="paramname"><em>priority</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>firstByteTransmitTime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a0fb2219714cd80537f235ceb3984f7d9">ListElt</a> *&#160;</td>
          <td class="paramname"><em>elt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>effectiveVolumeLimit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the effective volume limit, algorithm explained at: SABR 3.2.6.8.9. </p>
<dl class="section user"><dt>Function Name:</dt><dd>computeEffectiveVolumeLimit</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success case: The EVL has been computed </td></tr>
    <tr><td class="paramname">-1</td><td>The first byte transmit time for the contact is later than the lower stop time between all contacts from this contact to the last contact of the hops list</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*contact</td><td>A contact of the hops list. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">priority</td><td>The priority level of the bundle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">firstByteTransmitTime</td><td>The first byte transmit time for the sender node of the contact </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*elt</td><td>The ListElt for which the contact is the data field </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*effectiveVolumeLimit</td><td>The effective volume limit computed, only in success case</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>contact doesn't have to be NULL </dd>
<dd>
elt doesn't have to be NULL </dd>
<dd>
effectiveVolumeLimit doesn't have to be NULL</dd></dl>
<dl class="section user"><dt>Notes:</dt><dd><ol type="1">
<li>To understand the terminology and the algorithm look at SABR from 3.2.6.8.5 to 3.2.6.8.9</li>
</ol>
</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="ad9b6bde3e2b540750c9606562b5b5c26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9b6bde3e2b540750c9606562b5b5c26">&#9670;&nbsp;</a></span>computeExpectedBundleDeliveryTime()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int computeExpectedBundleDeliveryTime </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>current_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_cgr_bundle.html">CgrBundle</a> *&#160;</td>
          <td class="paramname"><em>bundle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_cgr_scalar.html">CgrScalar</a> *&#160;</td>
          <td class="paramname"><em>residualBacklog</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t *&#160;</td>
          <td class="paramname"><em>lastByteArrivalTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the route is viable for the forwarding of the bundle, compute the ETO, compute the PBAT and compute the RVL. </p>
<dl class="section user"><dt>Function Name:</dt><dd>computeExpectedBundleDeliveryTime</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success case: The route is viable for the forwarding of the bundle and the PBAT has been computed </td></tr>
    <tr><td class="paramname">-1</td><td>The route isn't viable for the forwarding of the bundle, PBAT hasn't been computed</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">current_time</td><td>The time used during the current call </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*bundle</td><td>The bundle that has to be forwarded </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*route</td><td>The route to check and to update the pbat, owltSum, routeVolumeLimit and arrivalTime fields. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*residualBacklog</td><td>The residual backlog for the neighbor identified by the first hop destination node of the route </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*lastByteArrivalTime</td><td>(PBAT) The expected arrival time at the destionation node for the last byte of the bundle</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>bundle doesn't have to be NULL </dd>
<dd>
route doesn't have to be NULL </dd>
<dd>
residualBacklog doesn't have to be NULL </dd>
<dd>
effectiveVolumeLimit doesn't have to be NULL</dd></dl>
<dl class="section user"><dt>Notes:</dt><dd><ol type="1">
<li>To understand the terminology and the algorithm look at SABR from 3.2.6.2 to 3.2.6.8.11</li>
<li>This function will update the route's fields computed in phase one:<ul>
<li>owltSum</li>
<li>arrivalTime</li>
</ul>
</li>
</ol>
</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="af0fdd1e16bf8bd7fa9ecb9aaf55924d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0fdd1e16bf8bd7fa9ecb9aaf55924d0">&#9670;&nbsp;</a></span>computePBAT()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int computePBAT </td>
          <td>(</td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>current_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long&#160;</td>
          <td class="paramname"><em>localNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_cgr_bundle.html">CgrBundle</a> *&#160;</td>
          <td class="paramname"><em>bundle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the route is viable for the forwarding of the bundle, compute the ETO, computed the PBAT and check for potential overbooking. </p>
<dl class="section user"><dt>Function Name:</dt><dd>computePBAT</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success case: The route is viable for the forwarding of the bundle and, in particular, the PBAT has been computed. </td></tr>
    <tr><td class="paramname">-1</td><td>Error case: The route isn't viable for the forwarding of the bundle, PBAT can't be computed </td></tr>
    <tr><td class="paramname">-2</td><td>Error case: The applicable backlog can't be computed </td></tr>
    <tr><td class="paramname">-3</td><td>Error case: The residual backlog can't be computed </td></tr>
    <tr><td class="paramname">-4</td><td>Error case: The PBAT has been computed but is later than the bundle's deadline</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">current_time</td><td>The time used during the current call </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">localNode</td><td>The node on which Unibo-CGR is running </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*route</td><td>The route to check </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*bundle</td><td>The bundle that has to be forwarded</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>bundle doesn't have to be NULL </dd>
<dd>
route doesn't have to be NULL</dd></dl>
<dl class="section user"><dt>Notes:</dt><dd><ol type="1">
<li>At the end, in success case, the following route's fields will be updated:<ul>
<li>eto</li>
<li>pbat</li>
<li>routeVolumeLimit</li>
<li>owltSum</li>
<li>arrivalTime</li>
<li>bundleEVC</li>
<li>protected</li>
<li>overbooked</li>
</ul>
</li>
</ol>
</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="aaacb87a7894211d1b1b01da87dca277c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaacb87a7894211d1b1b01da87dca277c">&#9670;&nbsp;</a></span>computeResidualBacklog()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int computeResidualBacklog </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>regionNbr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>current_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long&#160;</td>
          <td class="paramname"><em>localNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_cgr_scalar.html">CgrScalar</a> *&#160;</td>
          <td class="paramname"><em>allotment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_cgr_scalar.html">CgrScalar</a> *&#160;</td>
          <td class="paramname"><em>volume</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_cgr_scalar.html">CgrScalar</a> *&#160;</td>
          <td class="paramname"><em>residualBacklog</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Compute the residual backlog for the neighbor (identified from the first hop destination node of the route) and some other fields to manage the potential overbooking (route-&gt;protected, allotment and volume) </p>
<dl class="section user"><dt>Function Name:</dt><dd>computeResidualBacklog</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>There is at least one contact from the local node to the neighbor with a start time less or equal than the route's first contact start time. </td></tr>
    <tr><td class="paramname">-1</td><td>No contacts found from the local node to the neighbor with a start time less or equal than the route's first contact, that case should never happens</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">current_time</td><td>The time used during the current call </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">localNode</td><td>The IPN number of the node on which Unibo-CGR is running </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*route</td><td>The route, used fields: neighbor, protected. Initially route-&gt;protected contains the total backlog, at the end it will contains the amount of bytes that will not be reforwarded by the overbooking management </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*allotment</td><td>Bytes that could be overbooked </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*volume</td><td>Applicable contact volume of the first contact of the route, computed as the product of the xmitRate and the applicable duration </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">*residualBacklog</td><td>Initially it contains the applicable backlog, at the end it will contains the residual backlog</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>route doesn't have to be NULL </dd>
<dd>
allotment doesn't have to be NULL </dd>
<dd>
volume doesn't have to be NULL </dd>
<dd>
residualBacklog doesn't have to be NULL</dd></dl>
<dl class="section user"><dt>Notes:</dt><dd><ol type="1">
<li>The terminology and how to compute the residual backlog are explained in the SABR algorithm at the point 3.2.6.2 ( from a) to g) )</li>
<li>In this function the route-&gt;protected field will be updated (overbooking management).</li>
</ol>
</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a8d8008e926aba4248946a793115e385d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d8008e926aba4248946a793115e385d">&#9670;&nbsp;</a></span>destroy_phase_two()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void destroy_phase_two </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Deallocate all the memory allocated by the phase two. </p>
<dl class="section user"><dt>Function Name:</dt><dd>destroy_phase_two</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a2053e28a3f1ee3150bd048d6a1a15775"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2053e28a3f1ee3150bd048d6a1a15775">&#9670;&nbsp;</a></span>get_phase_two_sap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="struct_phase_two_s_a_p.html">PhaseTwoSAP</a>* get_phase_two_sap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_phase_two_s_a_p.html">PhaseTwoSAP</a> *&#160;</td>
          <td class="paramname"><em>newSap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get the <a class="el" href="struct_phase_two_s_a_p.html" title="Used to keep in one place all the data used by phase two.">PhaseTwoSAP</a> with all the values used by phase two during the current call. </p>
<dl class="section user"><dt>Function Name:</dt><dd>get_current_call_sap</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>02/07/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>PhaseTwoSAP*</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">PhaseTwoSAP*</td><td>The struct with all the values used by phase two during the current call</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*newSap</td><td>If you just want a reference to the SAP set NULL here; otherwise set != NULL (the previous one will be overwritten).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">02/07/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a8e7a5ca4e6091f6e069317d3e4e65c31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e7a5ca4e6091f6e069317d3e4e65c31">&#9670;&nbsp;</a></span>getCandidateRoutes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int getCandidateRoutes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="nodes_8h.html#ac09cf950484bd9550d14d602b0e5e7fb">Node</a> *&#160;</td>
          <td class="paramname"><em>terminusNode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_cgr_bundle.html">CgrBundle</a> *&#160;</td>
          <td class="paramname"><em>bundle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a>&#160;</td>
          <td class="paramname"><em>excludedNeighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a>&#160;</td>
          <td class="paramname"><em>computedRoutes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> *&#160;</td>
          <td class="paramname"><em>subsetComputedRoutes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int *&#160;</td>
          <td class="paramname"><em>missingNeighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a> *&#160;</td>
          <td class="paramname"><em>candidateRoutes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check all the computed routes and populate the candidate routes list. </p>
<dl class="section user"><dt>Function Name:</dt><dd>getCandidateRoutes</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Go back to phase one </td></tr>
    <tr><td class="paramname">&gt; 0</td><td>Number of routes in candidate routes list. </td></tr>
    <tr><td class="paramname">-1</td><td>Arguments error </td></tr>
    <tr><td class="paramname">-2</td><td>MWITHDRAW error, candidateRoutes points to NULL</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">*terminusNode</td><td>The destination node </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*bundle</td><td>The bundle that has to be forwarded </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">excludedNeighbors</td><td>The excluded nodes list SABR 3.2.5.2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">computedRoutes</td><td>The routes to check </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*subsetComputedRoutes</td><td>The set of routes that this phase recommend to phase one. Each route in this set should be used to compute other routes (Yen). </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*missingNeighbors</td><td>The number of "missing" neighbors. We want a route for each of these neighbors. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">*candidateRoutes</td><td>The candidate routes, NULL only if the return value is less than 1 and not equal to -10.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Notes:</dt><dd><ol type="1">
<li>In success case candidateRoutes will be a subset of computedRoutes, otherwise candidateRoutes will points to NULL</li>
</ol>
</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">27/04/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Refactoring    </td></tr>
</table>

</div>
</div>
<a id="af5450d4081211d44ddcb642b62a08717"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5450d4081211d44ddcb642b62a08717">&#9670;&nbsp;</a></span>initialize_phase_two()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int initialize_phase_two </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the data used by the phase two. </p>
<dl class="section user"><dt>Function Name:</dt><dd>initialize_phase_two</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>Success case: phase two initialized </td></tr>
    <tr><td class="paramname">-2</td><td>MWITHDRAW error</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="acecc44affaf421e9b11b230103932486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acecc44affaf421e9b11b230103932486">&#9670;&nbsp;</a></span>insert_route_in_subset_computed_routes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int insert_route_in_subset_computed_routes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_neighbor.html">Neighbor</a> *&#160;</td>
          <td class="paramname"><em>neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *&#160;</td>
          <td class="paramname"><em>newSubsetRoute</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Insert a computed route into subset of computed routes that phase two recommends to phase one for Yen's algorithm. </p>
<dl class="section user"><dt>Function Name:</dt><dd>insert_route_in_subset_computed_routes</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>30/04/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>Route added into the subset </td></tr>
    <tr><td class="paramname">0</td><td>Phase one will discard this route, so don't add it into the subset (OR neighbor not found) </td></tr>
    <tr><td class="paramname">-2</td><td>MWITHDRAW error</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">neighbor</td><td>The route's neighbor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newSubsetRoute</td><td>The route to add in the subset</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">30/04/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a39f09c16f15afae99d155a2e078446cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39f09c16f15afae99d155a2e078446cb">&#9670;&nbsp;</a></span>isExcluded()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int isExcluded </td>
          <td>(</td>
          <td class="paramtype">unsigned long long&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a>&#160;</td>
          <td class="paramname"><em>excludedNeighbors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if "target" is an excluded neighbor. </p>
<dl class="section user"><dt>Function Name:</dt><dd>isExcluded</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>target is an excluded neighbor. </td></tr>
    <tr><td class="paramname">0</td><td>target isn't an excluded neighbor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">target</td><td>Is this ipn node number included into the excludedNeighbors list? </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">excludedNeighbors</td><td>The list of excluded neighbors</td></tr>
  </table>
  </dd>
</dl>
<dl class="section warning"><dt>Warning</dt><dd>This function assumes that excludedNeighbors is not NULL.</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a76a36930c067205b26632404c84e283d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76a36930c067205b26632404c84e283d">&#9670;&nbsp;</a></span>lowDlvConfidence()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int lowDlvConfidence </td>
          <td>(</td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>bundleDlvConfidence</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>routeArrivalConfidence</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Check if the route arrival confidence add to the bundle's delivery confidence a confidence less than the MIN_CONFIDENCE_IMPROVEMENT. </p>
<dl class="section user"><dt>Function Name:</dt><dd>lowDlvConfidence</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Confidence ok for the forwarding of the bundle </td></tr>
    <tr><td class="paramname">1</td><td>The route can't be used due to low confidence.</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">bundleDlvConfidence</td><td>The current delivery confidence of the bundle </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">routeArrivalConfidence</td><td>The route's arrival confidence</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a3e5100099dcb783b0ad89b8e65785cf6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e5100099dcb783b0ad89b8e65785cf6">&#9670;&nbsp;</a></span>phase_one_conversation_management()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int phase_one_conversation_management </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="phase__two_8c.html#aad6dd0bba749083683c6d79d30324390">PhaseTwoRouteFlag</a>&#160;</td>
          <td class="paramname"><em>routeFlag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *&#160;</td>
          <td class="paramname"><em>route</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>neighbors_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>max_neighbors_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Manage the feedback that phase two provides to phase one. </p>
<dl class="section user"><dt>Function Name:</dt><dd>phase_one_conversation_management</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>30/04/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>Success case: nothing to do, we have already found a candidate route for N neighbors </td></tr>
    <tr><td class="paramname">0</td><td>Success case </td></tr>
    <tr><td class="paramname">-1</td><td>route's neighbor not found </td></tr>
    <tr><td class="paramname">-2</td><td>MWITHDRAW error</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">routeFlag</td><td>Flag used to know if route is a candidate or discarded route </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">*route</td><td>Generally a route, it could be a candidate route or not </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">neighbors_limit</td><td>We want a candidate route for N neighbors, where N is the limit. This is the initial value of missing neighbors (N), so the real number of missing neighbors is done by the result of "neighbors_limit - neighborsFound " (if greater than 0, obv). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">max_neighbors_number</td><td>The total number of neighbors to reach destination</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">30/04/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a3266c2b610c3ae185e1ca21012259040"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3266c2b610c3ae185e1ca21012259040">&#9670;&nbsp;</a></span>reached_neighbors_limit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int reached_neighbors_limit </td>
          <td>(</td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>neighborsFound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>suppressedFound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>neighborsLimit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long unsigned int&#160;</td>
          <td class="paramname"><em>maxNeighborsNumber</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check if we found a candidate route for at least N neighbors (or all). So if we reached the limit. </p>
<dl class="section user"><dt>Function Name:</dt><dd>reached_neighbors_limit</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>13/05/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>Limit reached </td></tr>
    <tr><td class="paramname">0</td><td>Limit not reached</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">neighborsFound</td><td>The number of neighbors that currently are associated with at least one candidate route. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">suppressedFound</td><td>The number of suppressed neighbors (e.g. excluded, or closing loop with a candidate route). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">neighborsLimit</td><td>The total number of neighbors for which we want a candidate route, including those already found. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">maxNeighborsNumber</td><td>The total number of neighbors for which we could find a route to destination</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">13/05/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="af8a6433f524a83920c94c1365997be59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8a6433f524a83920c94c1365997be59">&#9670;&nbsp;</a></span>remove_neighbor_from_subset_computed_routes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void remove_neighbor_from_subset_computed_routes </td>
          <td>(</td>
          <td class="paramtype">unsigned long long&#160;</td>
          <td class="paramname"><em>newNeighbor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Remove all routes (with the neighbor passed as argument) from the subset. </p>
<dl class="section user"><dt>Function Name:</dt><dd>remove_neighbor_from_subset_computed_routes</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>30/04/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">newNeighbor</td><td>The neighbor of the routes to remove</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">30/04/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a73c02ea4a81583e33891590bf0e9cf4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a73c02ea4a81583e33891590bf0e9cf4a">&#9670;&nbsp;</a></span>reset_phase_two()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reset_phase_two </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reset the routes list, so at the end it will be empty. </p>
<dl class="section user"><dt>Function Name:</dt><dd>reset_phase_two</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>06/02/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>void</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">06/02/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a8d3984089e5ee430ea79fcb591f4dfa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d3984089e5ee430ea79fcb591f4dfa7">&#9670;&nbsp;</a></span>suppress_destination_excluded_neighbors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int suppress_destination_excluded_neighbors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="nodes_8h.html#ac09cf950484bd9550d14d602b0e5e7fb">Node</a> *&#160;</td>
          <td class="paramname"><em>destination</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a>&#160;</td>
          <td class="paramname"><em>suppressedNeighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a>&#160;</td>
          <td class="paramname"><em>excludedNeighbors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Suppress only the neighbors to reach destination that are in the excludedNeighbors. </p>
<dl class="section user"><dt>Function Name:</dt><dd>suppress_destination_excluded_neighbors</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>30/04/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td>Success case </td></tr>
    <tr><td class="paramname">-2</td><td>MWITHDRAW error</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">destination</td><td>The destination from which we get the neighbors list </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">suppressedNeighbors</td><td>The list where we store the excluded neighbors, from now they become "suppressed" </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">excludedNeighbors</td><td>The excludedNeighbors list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">30/04/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="a1e6d2a368b05ecf144a24ed37db01266"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1e6d2a368b05ecf144a24ed37db01266">&#9670;&nbsp;</a></span>suppress_neighbor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int suppress_neighbor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="list__type_8h.html#a2f83d70457d96c5f0328f29529375850">List</a>&#160;</td>
          <td class="paramname"><em>suppressedNeighbors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long long *&#160;</td>
          <td class="paramname"><em>neighbor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Add the ipn node in the suppressedNeighbors list, only if it isn't already present. </p>
<dl class="section user"><dt>Function Name:</dt><dd>suppress_neighbor</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>30/04/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">0</td><td><a class="el" href="struct_neighbor.html">Neighbor</a> added into the suppressedNeighbors list </td></tr>
    <tr><td class="paramname">-1</td><td><a class="el" href="struct_neighbor.html">Neighbor</a> already present into the suppressedNeighbors list </td></tr>
    <tr><td class="paramname">-2</td><td>MWITHDRAW error</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">suppressedNeighbors</td><td>The list of suppressed neighbors where we add the new neighbor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">neighbor</td><td>The neighbor to add into the suppressed neighbors list</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">30/04/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
<a id="ad0548bf74d27974e3ce141b09ef4fb4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad0548bf74d27974e3ce141b09ef4fb4f">&#9670;&nbsp;</a></span>update_neighbors_counter()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int update_neighbors_counter </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="struct_neighbor.html">Neighbor</a> *&#160;</td>
          <td class="paramname"><em>neighbor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="routes_8h.html#a88b8c323d6cd602bd979ae688ad48006">Route</a> *&#160;</td>
          <td class="paramname"><em>newCandidateRoute</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Update the neighborsFound counter used during the current call. </p>
<dl class="section user"><dt>Function Name:</dt><dd>update_neighbors_counter</dd></dl>
<dl class="section user"><dt>Date Written:</dt><dd>30/04/20</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>int</dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">1</td><td>neighborsFound counter incremented by 1 </td></tr>
    <tr><td class="paramname">0</td><td>neighborsFound counter not incremented </td></tr>
    <tr><td class="paramname">-1</td><td>Error case: neighbor not found </td></tr>
    <tr><td class="paramname">-2</td><td>MWITHDRAW error</td></tr>
  </table>
  </dd>
</dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">neighbor</td><td>The neighbor of the newCandidateRoute </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">newCandidateRoute</td><td>The new candidate route found</td></tr>
  </table>
  </dd>
</dl>
<dl class="section user"><dt>Notes:</dt><dd><ol type="1">
<li>The counter will NOT be update ONLY if:<ul>
<li>We don't find the neighbor</li>
<li>The new candidate route has a failed/closing loop neighbor</li>
</ul>
</li>
<li>In case of failed/closing loop neighbor we add it to the suppressed neighbor list</li>
</ol>
</dd></dl>
<dl class="section user"><dt>Revision History:</dt><dd></dd></dl>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">DD/MM/YY   </th><th class="markdownTableHeadNone">AUTHOR   </th><th class="markdownTableHeadNone">DESCRIPTION    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">30/04/20   </td><td class="markdownTableBodyNone">L. Persampieri   </td><td class="markdownTableBodyNone">Initial Implementation and documentation.    </td></tr>
</table>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="http://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.0
</small></address>
</body>
</html>
